<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:VS="http://schemas.microsoft.com/wix/VSExtension" >
    <Fragment>
        <DirectoryRef Id="samplesFolder" FileSource="$(var.GallioTargetDir)\samples\">
            <Component Id="MbUnitSamples.zip" Guid="{0EF95DCA-1432-4bfd-B5C8-8D7F7419BB8E}" Win64="no">
                <File Name="MbUnitSamples.zip" KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="SamplesMenuFolder">
            <Component Id="MbUnitSamples.MenuShortcut" Guid="{7B70DB04-0ADA-4efa-9885-D4AB87938BEB}" Win64="no">
                <Condition>INSTALLSTARTMENUSHORTCUT</Condition>
                <CreateFolder />
                <RegistryKey Action="none" Root="HKCU" Key="Software\Gallio.org\Gallio\$(var.MajorVersion).$(var.MinorVersion)">
                    <RegistryValue Type="string" Value="[INSTALLDIR]" KeyPath="yes" />
                </RegistryKey>
                <Shortcut Id="MbUnitSamples.lnk" Name="MbUnit Samples" Target="[#MbUnitSamples.zip]" Directory="SamplesMenuFolder" WorkingDirectory="binFolder" Advertise="no" Show="normal" />
                <RemoveFile Id="MbUnitSamples.lnk" On="uninstall" Name="[MbUnitSamples.lnk]" />
                <RemoveFolder Id="SamplesMenuFolder" On="uninstall" />
            </Component>
        </DirectoryRef>

        <Feature Id="feat_MbUnit3.Samples" Title="MbUnit Samples" Level="1" AllowAdvertise="no"
                 Description="Installs MbUnit code samples.">
            <ComponentRef Id="MbUnitSamples.zip" />
            <ComponentRef Id="MbUnitSamples.MenuShortcut"/>
        </Feature>
    </Fragment>
</Wix>
